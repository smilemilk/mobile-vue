(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6140d8d1"],{"2b6d":function(t,e,a){"use strict";a("f751");var s=a("6b6c"),n=a("c276");function i(t){return Object(s["a"])({url:n["a"].ajaxFront+"POS/queryTradeOrderSum",method:"get",params:Object.assign({},t,{POS:!0})})}function r(t){return Object(s["a"])({url:n["a"].ajaxFront+"POS/queryTradeOrder",method:"get",params:Object.assign({},t,{POS:!0})})}function u(t){return Object(s["a"])({url:n["a"].ajaxFront+"POS/queryRefundOrder",method:"get",params:Object.assign({},t,{POS:!0})})}function o(t){return Object(s["a"])({url:n["a"].ajaxFront+"POS/queryPayOrder",method:"get",params:Object.assign({},t,{POS:!0})})}function l(t){return Object(s["a"])({url:n["a"].ajaxFront+"POS/cancelOrder",method:"get",params:Object.assign({},t,{POS:!0})})}function c(t){return Object(s["a"])({url:n["a"].ajaxFront+"POS/refund",method:"get",params:Object.assign({},t,{POS:!0})})}e["a"]={getTradeSumAmount:i,getTrade:r,getRefund:u,getPay:o,cancel:l,refund:c}},"57fe":function(t,e,a){},"6b14":function(t,e,a){"use strict";e["a"]=function(){return{}}},"77f4":function(t,e,a){"use strict";var s=a("57fe"),n=a.n(s);n.a},abe3:function(t,e,a){},be94:function(t,e,a){"use strict";a.d(e,"a",function(){return n});var s=a("ade3");function n(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),n.forEach(function(e){Object(s["a"])(t,e,a[e])})}return t}},eae0:function(t,e,a){"use strict";a.r(e);var s,n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{staticClass:"bar-wrapper",attrs:{title:this.$route.meta.title,"left-arrow":"","z-index":999},on:{"click-left":t.navBackClick}}),a("div",{staticClass:"business_detail-wrapper container-wrapper",staticStyle:{"overflow-y":"auto"}},[a("div",{staticClass:"business_detail-container"},[a("refund-opera",{ref:"refund",attrs:{limitAmount:t.limitAmount},on:{submit:t.submitFetch}}),a("div",{staticClass:"title-division"},[t._v("订单信息")]),a("div",{staticClass:"detail-cells"},[t.businessInfo.discountAmount?a("div",{staticClass:"detail-cell"},[a("label",{staticClass:"detail-cell-label"},[t._v("优惠金额（元）")]),a("div",{staticClass:"detail-cell-right"},[a("span",{staticClass:"detail-cell-span"},[t._v(t._s(t._f("$_filters_moneyFormat_fen")(t.businessInfo.discountAmount)))])])]):t._e(),a("div",{staticClass:"detail-cell"},[a("label",{staticClass:"detail-cell-label"},[t._v("支付方式")]),a("span",{staticClass:"detail-cell-span"},[t._v(t._s("alipay"===t.businessInfo.payType?"支付宝":"wx"===t.businessInfo.payType?"微信":"wm"===t.businessInfo.payType?"微脉":"-"))])]),a("div",{staticClass:"detail-cell"},[a("label",{staticClass:"detail-cell-label"},[t._v(t._s("alipay"===t.businessInfo.payType?"支付宝":"wx"===t.businessInfo.payType?"微信":"wm"===t.businessInfo.payType?"微脉":"")+"订单号")]),a("span",{staticClass:"detail-cell-span"},[t._v(t._s(t.businessInfo.tradeThirdNo||"-"))])]),a("div",{staticClass:"detail-cell media"},[a("label",{staticClass:"detail-cell-label"},[t._v("支付流水号")]),a("div",{staticClass:"detail-cell-right"},[t.businessInfo.tradeOrderNo&&t.businessInfo.tradeOrderNo.length>30?a("span",{staticClass:"detail-cell-span"},[a("span",{staticClass:"detail-cell-span-text"},[t._v(t._s(t.businessInfo.tradeOrderNo))])]):a("span",{staticClass:"detail-cell-span"},[t._v("\n                            "+t._s(t.businessInfo.tradeOrderNo||"-"))])])]),a("div",{staticClass:"detail-cell"},[a("label",{staticClass:"detail-cell-label"},[t._v("操作人")]),a("div",{staticClass:"detail-cell-right"},[a("span",{staticClass:"detail-cell-span"},[t._v(t._s(t.businessInfo.operatorName||"-"))])])]),a("div",{staticClass:"detail-cell"},[a("label",{staticClass:"detail-cell-label"},[t._v("创建时间")]),a("div",{staticClass:"detail-cell-right"},[t.businessInfo.createTime?a("span",{staticClass:"detail-cell-span"},[t._v(t._s(t._f("$_filters_parseTime")(t.businessInfo.createTime)))]):a("span",{staticClass:"detail-cell-span"},[t._v("-")])])]),t.businessInfo.remark?a("div",{staticClass:"detail-cell media"},[a("label",{staticClass:"detail-cell-label"},[t._v("备注")]),a("div",{staticClass:"detail-cell-right"},[t.businessInfo.remark.length>30?a("span",{staticClass:"detail-cell-span"},[a("span",{staticClass:"detail-cell-span-text"},[t._v(t._s(t.businessInfo.remark))])]):a("span",{staticClass:"detail-cell-span"},[t._v("\n                            "+t._s(t.businessInfo.remark))])])]):t._e()])],1),a("div",{staticClass:"refund-btn-fixed"},[a("div",{staticClass:"refund-btn-wrapper"},[a("button",{staticClass:"\n                        refund-btn-cancel\n                        btn\n                     ",on:{click:function(e){t.navBackClick()}}},[t._v("取消\n                ")]),a("button",{staticClass:"\n                     btn\n                     refund-btn-ensure\n                     ",on:{click:function(e){t.refundSubmit()}}},[t._v("确定退款\n                ")])])])])],1)},i=[],r=(a("e7e5"),a("d399")),u=a("be94"),o=(a("f751"),a("ade3")),l=(a("e17f"),a("2241")),c=(a("f908"),a("b528")),d=(a("19de"),a("234f")),f=(a("93ac"),a("bb33")),m=(a("4b0a"),a("2bb1")),b=(a("7844"),a("5596")),h=(a("0653"),a("34e9")),p=(a("c194"),a("7744")),O=(a("c3a6"),a("ad06")),v=(a("81e6"),a("9ffb")),y=(a("5f1a"),a("a3e2")),S=(a("cadf"),a("551c"),a("097d"),a("6b14")),j=a("2b6d"),g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{},[a("div",{staticClass:"refund-inner"},[a("div",{staticClass:"item pb3",class:1===this.refundInputStatus[0]?"bB1":""},[a("div",{staticClass:"item-label"},[t._v("退款金额（元）")]),a("div",{staticClass:"cashier-input"},[a("div",{staticClass:"flex-content flex-content-align"},[a("div",{staticClass:"cashier-input-unit mr4"},[t._v("￥")]),a("input",{directives:[{name:"model",rawName:"v-model",value:this.amount,expression:"this.amount"}],staticClass:"item-input amount-input",class:t.cursorStatus?"cursor":"",attrs:{maxlength:"9",placeholder:"0.00"},domProps:{value:this.amount},on:{focus:function(e){t.keyFocus()},input:function(e){e.target.composing||t.$set(this,"amount",e.target.value)}},nativeOn:{touchstart:function(e){e.stopPropagation(),t.keyboardShow=!0}}})]),a("p",{directives:[{name:"show",rawName:"v-show",value:0===t.refundRule[0]&&!0===t.refundRuleTextStatus,expression:"refundRule[0] === 0 &&\n                           refundRuleTextStatus === true"}],staticClass:"item-notice"},[t._v("不能为空")])])]),a("div",{staticClass:"mt10"},[t.remarkShow?a("div",{staticClass:"item pt0",class:1===this.refundInputStatus[1]?"bB1":""},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.remark,expression:"remark"}],staticClass:"item-input remark",staticStyle:{width:"100%"},attrs:{placeholder:"请输入退款备注"},domProps:{value:t.remark},on:{input:function(e){e.target.composing||(t.remark=e.target.value)}}})]):a("div",[a("span",{staticClass:"font-n-b",on:{click:function(e){t.remarkToggleHandle()}}},[t._v("添加退款备注")])])])]),a("van-number-keyboard",{attrs:{show:t.keyboardShow,"extra-key":".","close-button-text":"完成"},on:{blur:function(e){t.keyboardShow=!1},input:t.onInput,delete:t.onDelete}})],1)])},C=[],_=(a("28a5"),a("5246"),a("6b41")),k=(a("8fec"),a("7bd9")),I=function(){return{refundRule:[0,0],refundRuleText:["请输入金额"],refundInputStatus:[0,0],refundStatus:!0,refundRuleTextStatus:void 0,remarkShow:!1,amount:"",remark:""}},w=a("3ddc"),T={name:"RefundOpera",components:(s={},Object(o["a"])(s,y["a"].name,y["a"]),Object(o["a"])(s,v["a"].name,v["a"]),Object(o["a"])(s,O["a"].name,O["a"]),Object(o["a"])(s,p["a"].name,p["a"]),Object(o["a"])(s,h["a"].name,h["a"]),Object(o["a"])(s,b["a"].name,b["a"]),Object(o["a"])(s,m["a"].name,m["a"]),Object(o["a"])(s,f["a"].name,f["a"]),Object(o["a"])(s,d["a"].name,d["a"]),Object(o["a"])(s,c["a"].name,c["a"]),Object(o["a"])(s,"NumberKeyboard",k["a"]),Object(o["a"])(s,"NavBar",_["a"]),s),props:{limitAmount:{type:String,default:""}},data:function(){return Object.assign(I.call(this),{keyboardShow:!0,cursorStatus:!1})},created:function(){console.log(this.limitAmount),1==this.keyboardShow&&0==this.amount.length&&(this.cursorStatus=!0)},watch:{amount:function(t,e){if(t){if(this.cursorStatus=!t,this.refundRule[0]=1,this.btnStatus=1*t>0,this.remark?this.refundStatus=!0:this.refundStatus=!1,100*t>1*this.limitAmount)return this.btnStatus=!1,Object(r["a"])("输入的金额大于最大退款额"),void(this.amount=e);if(Math.floor(1*t)>1e5)return this.btnStatus=!1,Object(r["a"])("可输入的最大金额为100,000"),void(this.amount=e)}else this.btnStatus=!1,this.refundRule[0]=0,this.btnStatus=!1;t!==e?(this.refundInputStatus[0]=1,this.refundInputStatus[1]=0):this.refundInputStatus[0]=0},remark:function(t,e){if(this.refundRule[1]=t?1:0,t!==e?(this.refundInputStatus[0]=0,this.refundInputStatus[1]=1):this.refundInputStatus[1]=0,Object(w["a"])(t+"")>100)return this.remark=e,void Object(r["a"])("备注在100个字符之内")}},mounted:function(){var t=this;this.$on("getValue",function(){t.submitAction()})},methods:{submitAction:function(){if(!1===this.btnStatus)return this.amount||Object(r["a"])("请输入收款金额"),void(Math.floor(this.amount)>1e5&&Object(r["a"])("可输入的最大金额为100,000"));"1,1"===this.refundRule.join()||"1,0"===this.refundRule.join()?(this.refundStatus=!0,this.refundRuleTextStatus=!1,this.$emit("submit",{amount:this.amount})):(this.refundStatus=!1,this.refundRuleTextStatus=!0)},remarkToggleHandle:function(){this.remarkShow=!0},onInput:function(t){"."===t&&(this.amount+"").indexOf(".")>-1||("0"!==t&&0!==t||this.amount+""!=="0")&&(this.amount+""==="0"&&"."!==t||(this.amount+"").indexOf(".")>-1&&(this.amount+"").split(".")[1].length>1||(this.amount=this.amount+(t+"")))},onDelete:function(){(this.amount+"").length>0&&(this.amount=this.amount.substring(0,this.amount.length-1),this.amount?this.cursorStatus=!1:this.cursorStatus=!0)},keyFocus:function(){this.keyboardShow=!0,document.activeElement.blur()}}},N=T,x=(a("f55d"),a("2877")),P=Object(x["a"])(N,g,C,!1,null,"ffd97b72",null);P.options.__file="refund.vue";var R,A=P.exports,$=a("3f43"),q={components:(R={},Object(o["a"])(R,y["a"].name,y["a"]),Object(o["a"])(R,v["a"].name,v["a"]),Object(o["a"])(R,O["a"].name,O["a"]),Object(o["a"])(R,p["a"].name,p["a"]),Object(o["a"])(R,h["a"].name,h["a"]),Object(o["a"])(R,b["a"].name,b["a"]),Object(o["a"])(R,m["a"].name,m["a"]),Object(o["a"])(R,f["a"].name,f["a"]),Object(o["a"])(R,d["a"].name,d["a"]),Object(o["a"])(R,c["a"].name,c["a"]),Object(o["a"])(R,"RefundOpera",A),Object(o["a"])(R,"Dialog",l["a"]),R),data:function(){return Object.assign(S["a"].call(this),{queryOrder:{payOrderNo:""},businessInfo:{discountAmount:"",payType:"",tradeOrderName:"",tradeAmount:"",tradeOrderNo:"",operatorName:"",createTime:"",remark:""},limitAmount:this.$route.query.amount+""||""})},created:function(){this.queryOrder.payOrderNo=this.$route.query.tradeOrderNo,this.getOrderDetail()},methods:{getOrderDetail:function(){var t=this;j["a"].getPay(this.queryOrder).then(function(e){if(!0!==!e.success){if(t.businessInfo=Object(u["a"])({},t.businessInfo,{discountAmount:e.data.discountAmount||"",tradeAmount:e.data.buyerPayAmount||"",tradeOrderNo:e.data.payOrderNo||"",operatorName:e.data.operName||"",createTime:e.data.createTime||"",remark:e.data.paySubmitRemark||""}),e.data.items)for(var a in e.data.items)if(e.data.items[a].payType){t.businessInfo.payType=Object($["c"])(e.data.items[a].payType),t.businessInfo.tradeThirdNo=e.data.items[a].settleNo;break}}else t.businessInfo={}}).catch(function(){t.businessInfo={}})},refundSubmit:function(){var t=this;l["a"].confirm({title:"确认对该笔交易进行退款?",message:""}).then(function(){t.$refs.refund.$emit("getValue")}).catch(function(){})},submitFetch:function(t){var e=this,a=r["a"].loading({mask:!0,message:"退款请求中..."});j["a"].refund({payOrderNo:this.queryOrder.tradeOrderNo,refundAmount:100*t.amount,refundId:Math.floor(1e16*Math.random()+1)+"",remark:"3"}).then(function(t){var s,n;if(a.clear(),!0===!t.success)return s="0",n="退款请求失败",void e.$toast(t.msg||n);"3"!==t.data.refundOrderStatus&&3!==t.data.refundOrderStatus||(s="0",n=t.data.errorMessage),setTimeout(function(){e.$router.push({name:"businessRefundResult",query:{tradeOrderNo:e.$route.query.tradeOrderNo,refundOrderNo:t.data.refundOrderNo,resultStatus:s,msg:n}})},800)}).catch(function(){Object(r["a"])("退款失败"),a.clear()})},ensureAction:function(){},navBackClick:function(){var t=this;setTimeout(function(){t.$router.push({name:"businessDetail",query:{tradeOrderNo:t.$route.query.tradeOrderNo,tradeType:t.$route.query.tradeType}})},800)}}},F=q,D=(a("77f4"),Object(x["a"])(F,n,i,!1,null,"9add4c92",null));D.options.__file="business-refund.vue";e["default"]=D.exports},f55d:function(t,e,a){"use strict";var s=a("abe3"),n=a.n(s);n.a}}]);
//# sourceMappingURL=chunk-6140d8d1.f2032c5a.js.map